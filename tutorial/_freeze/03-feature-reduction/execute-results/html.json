{
  "hash": "6db5a54bba08f0eb906bf0e31d127b6c",
  "result": {
    "markdown": "---\ntitle: \"3. Feature Reduction\"\nbibliography: [packages.bib, ../referencesZotero.bib]\ncsl: ../apa.csl\n---\n\n\n\n\nOnce a meaningful set of time series features has been extracted for each variable and participant, the total number of data points sometimes remains too large for the desired clustering algorithm [@altman2018]. In such cases, it is often recommended to perform an (optional) feature reduction. The commmonly used feature reduction procedures can commonly be separated into _feature selection_ and _feature projection_. We provide a more detailed discussion of the pros and cons of the different approaches. For this illustration we focus on feature projections, which have been popular because they are efficient, widely available, and applicable to a wide range of data types. That being said, because feature selection procedures have the benefit that they retain the interpretable feature labels directly and immediately indicate which features were most informative in the sample [@carreira-perpinan1997], we recommend users to carefully consider the most useful option for their use case.\n\nIt is important to note again that a feature reduction step is not always necessary. Especially methods such as k-means are well equipped to deal with relatively large data sets [@jain2010]. It is important to check whether the full feature set leads to convergence issues or unstable cluster solutions. We go through the feature reduction steps as an exemplary illustration only.\n\n## Principal Component Analysis\n\n We, specifically, selected the commonly used _principal component analysis_ (PCA). PCAs have the distinct benefit that they are well-established within the psychometric literature [@jolliffe2011] and can broadly be applied to a wide variety of studies in an automatized manner [@abdi2010]. As our aim is to present a general illustration that can also be adopted across use cases, we present the workflow using a PCA here but we encourage users to consider more specialized methods as well.\n \n### Running the PCA\n \nTo use the PCA with our extracted time series features, we focus on a transformed feature set where the features are standardized across participants to ensure that all features are weighted equally. This transformation was already calculated as part of the `featureExtractor()` function and we now save it as a data frame `scaled_data`.\n\n\n\n::: {.cell}\n\n```{.r .numberLines .lineAnchors .cell-code}\nscaled_data <- featFullImp$featuresImpZMat %>% select(ends_with(feature_selection)) \n```\n:::\n\n\nWe then enter the standardized features into the principal component analysis using the `prcomp()` function from the `stats` package [@R-base]. \n\n\n::: {.cell}\n\n```{.r .numberLines .lineAnchors .cell-code}\nres.pca <- prcomp(scaled_data, scale. = FALSE)\npca_summary <- summary(res.pca)\n\n# extract explained variances\nres.varExplained <- data.frame(\n  Explained_Variance = cumsum(summary(res.pca)[[\"importance\"]]['Proportion of Variance',]),\n  Components = seq(1, length(cumsum(summary(res.pca)[[\"importance\"]]['Proportion of Variance',])), 1)\n)\n```\n:::\n\n\nThe PCA uses linear transformations in such a way that the first component captures the most possible variance of the original data (e.g., by finding a vector that maximizes the sum of squared distances; see @jolliffe2002, @abdi2010). The following components will then use the same method to iteratively explain the most of the remaining variance while also ensuring that the components are linearly uncorrelated [@shlens2014]. In practice, this meant that the PCA decomposed the 72 features into 72 principal components but now (because of the uncorrelated linear transformations) the first few principal components will capture a majority of the variance (see [@tbl-variance-decomposition]).\n\n\n::: {#tbl-variance-decomposition .cell tbl-cap='Variance Decomposition'}\n\n```{.r .numberLines .lineAnchors .cell-code}\n# Creating a data frame to hold variance details\nvariance_df <- data.frame(\n  Component = 1:length(pca_summary$sdev),\n  `Standard Deviation` = pca_summary$sdev,\n  `Proportion of Variance` = pca_summary$importance[2, ],\n  `Cumulative Proportion` = pca_summary$importance[3, ]\n)\n\n# Producing the kable output\nvariance_df %>%\n kbl(.,\n      escape = FALSE,\n      booktabs = TRUE,\n      label = \"pca_summary\",\n      format = \"html\",\n      digits = 2,\n      linesep = \"\",\n      col.names = c(\"Component\", \"Standard Deviation\", \"Proportion of Variance\", \"Cumulative Proportion\"),\n      caption = \"PCA Component Summary\") %>%\n  kable_classic(\n    full_width = FALSE,\n    lightable_options = \"hover\",\n    html_font = \"Cambria\"\n  ) %>%\n  scroll_box(width = \"100%\", height = \"500px\")\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div style=\"border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:500px; overflow-x: scroll; width:100%; \"><table class=\" lightable-classic lightable-hover\" style=\"font-family: Cambria; width: auto !important; margin-left: auto; margin-right: auto;\">\n<caption>PCA Component Summary</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:left;position: sticky; top:0; background-color: #FFFFFF;\">   </th>\n   <th style=\"text-align:right;position: sticky; top:0; background-color: #FFFFFF;\"> Component </th>\n   <th style=\"text-align:right;position: sticky; top:0; background-color: #FFFFFF;\"> Standard Deviation </th>\n   <th style=\"text-align:right;position: sticky; top:0; background-color: #FFFFFF;\"> Proportion of Variance </th>\n   <th style=\"text-align:right;position: sticky; top:0; background-color: #FFFFFF;\"> Cumulative Proportion </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> PC1 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 2.75 </td>\n   <td style=\"text-align:right;\"> 0.11 </td>\n   <td style=\"text-align:right;\"> 0.11 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> PC2 </td>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:right;\"> 2.51 </td>\n   <td style=\"text-align:right;\"> 0.09 </td>\n   <td style=\"text-align:right;\"> 0.19 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> PC3 </td>\n   <td style=\"text-align:right;\"> 3 </td>\n   <td style=\"text-align:right;\"> 1.97 </td>\n   <td style=\"text-align:right;\"> 0.05 </td>\n   <td style=\"text-align:right;\"> 0.25 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> PC4 </td>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:right;\"> 1.90 </td>\n   <td style=\"text-align:right;\"> 0.05 </td>\n   <td style=\"text-align:right;\"> 0.30 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> PC5 </td>\n   <td style=\"text-align:right;\"> 5 </td>\n   <td style=\"text-align:right;\"> 1.73 </td>\n   <td style=\"text-align:right;\"> 0.04 </td>\n   <td style=\"text-align:right;\"> 0.34 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> PC6 </td>\n   <td style=\"text-align:right;\"> 6 </td>\n   <td style=\"text-align:right;\"> 1.67 </td>\n   <td style=\"text-align:right;\"> 0.04 </td>\n   <td style=\"text-align:right;\"> 0.38 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> PC7 </td>\n   <td style=\"text-align:right;\"> 7 </td>\n   <td style=\"text-align:right;\"> 1.59 </td>\n   <td style=\"text-align:right;\"> 0.04 </td>\n   <td style=\"text-align:right;\"> 0.41 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> PC8 </td>\n   <td style=\"text-align:right;\"> 8 </td>\n   <td style=\"text-align:right;\"> 1.49 </td>\n   <td style=\"text-align:right;\"> 0.03 </td>\n   <td style=\"text-align:right;\"> 0.44 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> PC9 </td>\n   <td style=\"text-align:right;\"> 9 </td>\n   <td style=\"text-align:right;\"> 1.46 </td>\n   <td style=\"text-align:right;\"> 0.03 </td>\n   <td style=\"text-align:right;\"> 0.47 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> PC10 </td>\n   <td style=\"text-align:right;\"> 10 </td>\n   <td style=\"text-align:right;\"> 1.38 </td>\n   <td style=\"text-align:right;\"> 0.03 </td>\n   <td style=\"text-align:right;\"> 0.50 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> PC11 </td>\n   <td style=\"text-align:right;\"> 11 </td>\n   <td style=\"text-align:right;\"> 1.35 </td>\n   <td style=\"text-align:right;\"> 0.03 </td>\n   <td style=\"text-align:right;\"> 0.52 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> PC12 </td>\n   <td style=\"text-align:right;\"> 12 </td>\n   <td style=\"text-align:right;\"> 1.32 </td>\n   <td style=\"text-align:right;\"> 0.02 </td>\n   <td style=\"text-align:right;\"> 0.55 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> PC13 </td>\n   <td style=\"text-align:right;\"> 13 </td>\n   <td style=\"text-align:right;\"> 1.30 </td>\n   <td style=\"text-align:right;\"> 0.02 </td>\n   <td style=\"text-align:right;\"> 0.57 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> PC14 </td>\n   <td style=\"text-align:right;\"> 14 </td>\n   <td style=\"text-align:right;\"> 1.28 </td>\n   <td style=\"text-align:right;\"> 0.02 </td>\n   <td style=\"text-align:right;\"> 0.59 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> PC15 </td>\n   <td style=\"text-align:right;\"> 15 </td>\n   <td style=\"text-align:right;\"> 1.24 </td>\n   <td style=\"text-align:right;\"> 0.02 </td>\n   <td style=\"text-align:right;\"> 0.62 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> PC16 </td>\n   <td style=\"text-align:right;\"> 16 </td>\n   <td style=\"text-align:right;\"> 1.20 </td>\n   <td style=\"text-align:right;\"> 0.02 </td>\n   <td style=\"text-align:right;\"> 0.64 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> PC17 </td>\n   <td style=\"text-align:right;\"> 17 </td>\n   <td style=\"text-align:right;\"> 1.17 </td>\n   <td style=\"text-align:right;\"> 0.02 </td>\n   <td style=\"text-align:right;\"> 0.65 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> PC18 </td>\n   <td style=\"text-align:right;\"> 18 </td>\n   <td style=\"text-align:right;\"> 1.15 </td>\n   <td style=\"text-align:right;\"> 0.02 </td>\n   <td style=\"text-align:right;\"> 0.67 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> PC19 </td>\n   <td style=\"text-align:right;\"> 19 </td>\n   <td style=\"text-align:right;\"> 1.13 </td>\n   <td style=\"text-align:right;\"> 0.02 </td>\n   <td style=\"text-align:right;\"> 0.69 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> PC20 </td>\n   <td style=\"text-align:right;\"> 20 </td>\n   <td style=\"text-align:right;\"> 1.07 </td>\n   <td style=\"text-align:right;\"> 0.02 </td>\n   <td style=\"text-align:right;\"> 0.71 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> PC21 </td>\n   <td style=\"text-align:right;\"> 21 </td>\n   <td style=\"text-align:right;\"> 1.06 </td>\n   <td style=\"text-align:right;\"> 0.02 </td>\n   <td style=\"text-align:right;\"> 0.72 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> PC22 </td>\n   <td style=\"text-align:right;\"> 22 </td>\n   <td style=\"text-align:right;\"> 1.03 </td>\n   <td style=\"text-align:right;\"> 0.01 </td>\n   <td style=\"text-align:right;\"> 0.74 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> PC23 </td>\n   <td style=\"text-align:right;\"> 23 </td>\n   <td style=\"text-align:right;\"> 1.00 </td>\n   <td style=\"text-align:right;\"> 0.01 </td>\n   <td style=\"text-align:right;\"> 0.75 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> PC24 </td>\n   <td style=\"text-align:right;\"> 24 </td>\n   <td style=\"text-align:right;\"> 0.99 </td>\n   <td style=\"text-align:right;\"> 0.01 </td>\n   <td style=\"text-align:right;\"> 0.76 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> PC25 </td>\n   <td style=\"text-align:right;\"> 25 </td>\n   <td style=\"text-align:right;\"> 0.96 </td>\n   <td style=\"text-align:right;\"> 0.01 </td>\n   <td style=\"text-align:right;\"> 0.78 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> PC26 </td>\n   <td style=\"text-align:right;\"> 26 </td>\n   <td style=\"text-align:right;\"> 0.94 </td>\n   <td style=\"text-align:right;\"> 0.01 </td>\n   <td style=\"text-align:right;\"> 0.79 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> PC27 </td>\n   <td style=\"text-align:right;\"> 27 </td>\n   <td style=\"text-align:right;\"> 0.93 </td>\n   <td style=\"text-align:right;\"> 0.01 </td>\n   <td style=\"text-align:right;\"> 0.80 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> PC28 </td>\n   <td style=\"text-align:right;\"> 28 </td>\n   <td style=\"text-align:right;\"> 0.89 </td>\n   <td style=\"text-align:right;\"> 0.01 </td>\n   <td style=\"text-align:right;\"> 0.81 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> PC29 </td>\n   <td style=\"text-align:right;\"> 29 </td>\n   <td style=\"text-align:right;\"> 0.88 </td>\n   <td style=\"text-align:right;\"> 0.01 </td>\n   <td style=\"text-align:right;\"> 0.82 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> PC30 </td>\n   <td style=\"text-align:right;\"> 30 </td>\n   <td style=\"text-align:right;\"> 0.86 </td>\n   <td style=\"text-align:right;\"> 0.01 </td>\n   <td style=\"text-align:right;\"> 0.83 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> PC31 </td>\n   <td style=\"text-align:right;\"> 31 </td>\n   <td style=\"text-align:right;\"> 0.84 </td>\n   <td style=\"text-align:right;\"> 0.01 </td>\n   <td style=\"text-align:right;\"> 0.84 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> PC32 </td>\n   <td style=\"text-align:right;\"> 32 </td>\n   <td style=\"text-align:right;\"> 0.83 </td>\n   <td style=\"text-align:right;\"> 0.01 </td>\n   <td style=\"text-align:right;\"> 0.85 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> PC33 </td>\n   <td style=\"text-align:right;\"> 33 </td>\n   <td style=\"text-align:right;\"> 0.81 </td>\n   <td style=\"text-align:right;\"> 0.01 </td>\n   <td style=\"text-align:right;\"> 0.86 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> PC34 </td>\n   <td style=\"text-align:right;\"> 34 </td>\n   <td style=\"text-align:right;\"> 0.79 </td>\n   <td style=\"text-align:right;\"> 0.01 </td>\n   <td style=\"text-align:right;\"> 0.87 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> PC35 </td>\n   <td style=\"text-align:right;\"> 35 </td>\n   <td style=\"text-align:right;\"> 0.77 </td>\n   <td style=\"text-align:right;\"> 0.01 </td>\n   <td style=\"text-align:right;\"> 0.88 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> PC36 </td>\n   <td style=\"text-align:right;\"> 36 </td>\n   <td style=\"text-align:right;\"> 0.75 </td>\n   <td style=\"text-align:right;\"> 0.01 </td>\n   <td style=\"text-align:right;\"> 0.89 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> PC37 </td>\n   <td style=\"text-align:right;\"> 37 </td>\n   <td style=\"text-align:right;\"> 0.73 </td>\n   <td style=\"text-align:right;\"> 0.01 </td>\n   <td style=\"text-align:right;\"> 0.89 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> PC38 </td>\n   <td style=\"text-align:right;\"> 38 </td>\n   <td style=\"text-align:right;\"> 0.72 </td>\n   <td style=\"text-align:right;\"> 0.01 </td>\n   <td style=\"text-align:right;\"> 0.90 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> PC39 </td>\n   <td style=\"text-align:right;\"> 39 </td>\n   <td style=\"text-align:right;\"> 0.69 </td>\n   <td style=\"text-align:right;\"> 0.01 </td>\n   <td style=\"text-align:right;\"> 0.91 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> PC40 </td>\n   <td style=\"text-align:right;\"> 40 </td>\n   <td style=\"text-align:right;\"> 0.67 </td>\n   <td style=\"text-align:right;\"> 0.01 </td>\n   <td style=\"text-align:right;\"> 0.91 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> PC41 </td>\n   <td style=\"text-align:right;\"> 41 </td>\n   <td style=\"text-align:right;\"> 0.64 </td>\n   <td style=\"text-align:right;\"> 0.01 </td>\n   <td style=\"text-align:right;\"> 0.92 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> PC42 </td>\n   <td style=\"text-align:right;\"> 42 </td>\n   <td style=\"text-align:right;\"> 0.64 </td>\n   <td style=\"text-align:right;\"> 0.01 </td>\n   <td style=\"text-align:right;\"> 0.93 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> PC43 </td>\n   <td style=\"text-align:right;\"> 43 </td>\n   <td style=\"text-align:right;\"> 0.61 </td>\n   <td style=\"text-align:right;\"> 0.01 </td>\n   <td style=\"text-align:right;\"> 0.93 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> PC44 </td>\n   <td style=\"text-align:right;\"> 44 </td>\n   <td style=\"text-align:right;\"> 0.60 </td>\n   <td style=\"text-align:right;\"> 0.01 </td>\n   <td style=\"text-align:right;\"> 0.94 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> PC45 </td>\n   <td style=\"text-align:right;\"> 45 </td>\n   <td style=\"text-align:right;\"> 0.59 </td>\n   <td style=\"text-align:right;\"> 0.00 </td>\n   <td style=\"text-align:right;\"> 0.94 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> PC46 </td>\n   <td style=\"text-align:right;\"> 46 </td>\n   <td style=\"text-align:right;\"> 0.58 </td>\n   <td style=\"text-align:right;\"> 0.00 </td>\n   <td style=\"text-align:right;\"> 0.94 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> PC47 </td>\n   <td style=\"text-align:right;\"> 47 </td>\n   <td style=\"text-align:right;\"> 0.56 </td>\n   <td style=\"text-align:right;\"> 0.00 </td>\n   <td style=\"text-align:right;\"> 0.95 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> PC48 </td>\n   <td style=\"text-align:right;\"> 48 </td>\n   <td style=\"text-align:right;\"> 0.54 </td>\n   <td style=\"text-align:right;\"> 0.00 </td>\n   <td style=\"text-align:right;\"> 0.95 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> PC49 </td>\n   <td style=\"text-align:right;\"> 49 </td>\n   <td style=\"text-align:right;\"> 0.53 </td>\n   <td style=\"text-align:right;\"> 0.00 </td>\n   <td style=\"text-align:right;\"> 0.96 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> PC50 </td>\n   <td style=\"text-align:right;\"> 50 </td>\n   <td style=\"text-align:right;\"> 0.51 </td>\n   <td style=\"text-align:right;\"> 0.00 </td>\n   <td style=\"text-align:right;\"> 0.96 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> PC51 </td>\n   <td style=\"text-align:right;\"> 51 </td>\n   <td style=\"text-align:right;\"> 0.50 </td>\n   <td style=\"text-align:right;\"> 0.00 </td>\n   <td style=\"text-align:right;\"> 0.96 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> PC52 </td>\n   <td style=\"text-align:right;\"> 52 </td>\n   <td style=\"text-align:right;\"> 0.48 </td>\n   <td style=\"text-align:right;\"> 0.00 </td>\n   <td style=\"text-align:right;\"> 0.97 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> PC53 </td>\n   <td style=\"text-align:right;\"> 53 </td>\n   <td style=\"text-align:right;\"> 0.47 </td>\n   <td style=\"text-align:right;\"> 0.00 </td>\n   <td style=\"text-align:right;\"> 0.97 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> PC54 </td>\n   <td style=\"text-align:right;\"> 54 </td>\n   <td style=\"text-align:right;\"> 0.44 </td>\n   <td style=\"text-align:right;\"> 0.00 </td>\n   <td style=\"text-align:right;\"> 0.97 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> PC55 </td>\n   <td style=\"text-align:right;\"> 55 </td>\n   <td style=\"text-align:right;\"> 0.44 </td>\n   <td style=\"text-align:right;\"> 0.00 </td>\n   <td style=\"text-align:right;\"> 0.98 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> PC56 </td>\n   <td style=\"text-align:right;\"> 56 </td>\n   <td style=\"text-align:right;\"> 0.42 </td>\n   <td style=\"text-align:right;\"> 0.00 </td>\n   <td style=\"text-align:right;\"> 0.98 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> PC57 </td>\n   <td style=\"text-align:right;\"> 57 </td>\n   <td style=\"text-align:right;\"> 0.41 </td>\n   <td style=\"text-align:right;\"> 0.00 </td>\n   <td style=\"text-align:right;\"> 0.98 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> PC58 </td>\n   <td style=\"text-align:right;\"> 58 </td>\n   <td style=\"text-align:right;\"> 0.40 </td>\n   <td style=\"text-align:right;\"> 0.00 </td>\n   <td style=\"text-align:right;\"> 0.98 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> PC59 </td>\n   <td style=\"text-align:right;\"> 59 </td>\n   <td style=\"text-align:right;\"> 0.39 </td>\n   <td style=\"text-align:right;\"> 0.00 </td>\n   <td style=\"text-align:right;\"> 0.98 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> PC60 </td>\n   <td style=\"text-align:right;\"> 60 </td>\n   <td style=\"text-align:right;\"> 0.37 </td>\n   <td style=\"text-align:right;\"> 0.00 </td>\n   <td style=\"text-align:right;\"> 0.99 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> PC61 </td>\n   <td style=\"text-align:right;\"> 61 </td>\n   <td style=\"text-align:right;\"> 0.36 </td>\n   <td style=\"text-align:right;\"> 0.00 </td>\n   <td style=\"text-align:right;\"> 0.99 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> PC62 </td>\n   <td style=\"text-align:right;\"> 62 </td>\n   <td style=\"text-align:right;\"> 0.35 </td>\n   <td style=\"text-align:right;\"> 0.00 </td>\n   <td style=\"text-align:right;\"> 0.99 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> PC63 </td>\n   <td style=\"text-align:right;\"> 63 </td>\n   <td style=\"text-align:right;\"> 0.34 </td>\n   <td style=\"text-align:right;\"> 0.00 </td>\n   <td style=\"text-align:right;\"> 0.99 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> PC64 </td>\n   <td style=\"text-align:right;\"> 64 </td>\n   <td style=\"text-align:right;\"> 0.31 </td>\n   <td style=\"text-align:right;\"> 0.00 </td>\n   <td style=\"text-align:right;\"> 0.99 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> PC65 </td>\n   <td style=\"text-align:right;\"> 65 </td>\n   <td style=\"text-align:right;\"> 0.29 </td>\n   <td style=\"text-align:right;\"> 0.00 </td>\n   <td style=\"text-align:right;\"> 0.99 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> PC66 </td>\n   <td style=\"text-align:right;\"> 66 </td>\n   <td style=\"text-align:right;\"> 0.28 </td>\n   <td style=\"text-align:right;\"> 0.00 </td>\n   <td style=\"text-align:right;\"> 1.00 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> PC67 </td>\n   <td style=\"text-align:right;\"> 67 </td>\n   <td style=\"text-align:right;\"> 0.27 </td>\n   <td style=\"text-align:right;\"> 0.00 </td>\n   <td style=\"text-align:right;\"> 1.00 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> PC68 </td>\n   <td style=\"text-align:right;\"> 68 </td>\n   <td style=\"text-align:right;\"> 0.25 </td>\n   <td style=\"text-align:right;\"> 0.00 </td>\n   <td style=\"text-align:right;\"> 1.00 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> PC69 </td>\n   <td style=\"text-align:right;\"> 69 </td>\n   <td style=\"text-align:right;\"> 0.23 </td>\n   <td style=\"text-align:right;\"> 0.00 </td>\n   <td style=\"text-align:right;\"> 1.00 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> PC70 </td>\n   <td style=\"text-align:right;\"> 70 </td>\n   <td style=\"text-align:right;\"> 0.23 </td>\n   <td style=\"text-align:right;\"> 0.00 </td>\n   <td style=\"text-align:right;\"> 1.00 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> PC71 </td>\n   <td style=\"text-align:right;\"> 71 </td>\n   <td style=\"text-align:right;\"> 0.20 </td>\n   <td style=\"text-align:right;\"> 0.00 </td>\n   <td style=\"text-align:right;\"> 1.00 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> PC72 </td>\n   <td style=\"text-align:right;\"> 72 </td>\n   <td style=\"text-align:right;\"> 0.17 </td>\n   <td style=\"text-align:right;\"> 0.00 </td>\n   <td style=\"text-align:right;\"> 1.00 </td>\n  </tr>\n</tbody>\n</table></div>\n\n`````\n:::\n:::\n\n\n\n### Component Selection\n\nWe can then decide how much information (i.e., variance) we are willing to sacrifice for a reduced dimensionality. A common rule of thumb is to use the principal components that jointly explain 70--90% of the original variance [@jackson2003]. For our illustration, we chose a 80% of the cumulative percentage explained variance as the cutoff (i.e., `cutoff_percentage`)\n\n\n\n::: {.cell}\n\n```{.r .numberLines .lineAnchors .cell-code}\ncutoff_percentage <- 0.8\npca_cutoff <- min(which(cumsum(summary(res.pca)[[\"importance\"]]['Proportion of Variance',]) >= cutoff_percentage))\n```\n:::\n\n\nThis means that we select the first 27 principal components that explain 80% of the variance in the original 72 features (reducing the dimensionality by 62.50%).\n\n\n::: {.cell}\n\n```{.r .numberLines .lineAnchors .cell-code}\nfviz_eig(res.pca, \n         addlabels = TRUE, \n         choice = \"variance\",\n         ncp = pca_cutoff,\n         barfill = \"#a6a6a6\",\n         barcolor = \"transparent\",\n         main = \"Scree Plot of Explained Variance per Principal Component\",\n         xlab = \"Principal Components\") +\n         theme_Publication() +\n  theme(text = element_text(size = 14, color = \"#333333\"),\n        axis.title = element_text(size = 16, face = \"bold\", color = \"#555555\"),\n        plot.title = element_text(size = 18, hjust = 0.5, face = \"bold\", color = \"#444444\"),\n        legend.position = \"none\",\n        panel.grid.minor = element_blank())\n```\n\n::: {.cell-output-display}\n![](03-feature-reduction_files/figure-html/visualize variance explained-1.png){width=672}\n:::\n\n```{.r .numberLines .lineAnchors .cell-code}\nres.varExplained <- data.frame(\n  Explained_Variance = cumsum(summary(res.pca)[[\"importance\"]]['Proportion of Variance',]),\n  Components = seq(1, length(cumsum(summary(res.pca)[[\"importance\"]]['Proportion of Variance',])), 1)\n)\n\nggplot(data = res.varExplained, aes(x = Components, y = Explained_Variance)) +\n  geom_point() +\n  geom_line() +\n  geom_vline(mapping = aes(xintercept = pca_cutoff), linetype = \"longdash\") +\n  geom_hline(mapping = aes(yintercept = cutoff_percentage), linetype = \"longdash\") +\n  geom_text(aes(x = pca_cutoff, y = min(Explained_Variance) + 0.01), \n            label = paste0(pca_cutoff, \" components\"), hjust = -0.1, vjust = 0, size = 3) +\n  geom_text(aes(x = min(Components), y = cutoff_percentage), \n            label = paste0(cutoff_percentage*100, \"%\"), hjust = 0, vjust = -1, size = 3) +\n  labs(title = \"Cumulative Proportion of Variance Explained\",\n       x = \"Number of Components\",\n       y = \"Proportion of Variance Explained\") +\n  tsFeatureExtracR::theme_Publication()\n```\n\n::: {.cell-output-display}\n![](03-feature-reduction_files/figure-html/visualize variance explained-2.png){width=672}\n:::\n:::\n\n\nWe can then also get a slightly better of an understanding of how the data is distributed by visualizing the features and the participants within the lower dimensional space. We here chose the first three principal components to allow for human undestandable dimensionality.\n\n\n::: {.cell}\n\n```{.r .numberLines .lineAnchors .cell-code}\nplot1 <- plot_ly(\n  res.pca$rotation %>% as.data.frame,\n  x = ~ PC1,\n  y = ~ PC2,\n  z = ~ PC3,\n  size = 2,\n  type = 'scatter3d',\n  mode = 'markers',\n  text = ~ paste('Variable:', rownames(res.pca$rotation))\n) %>%\n  layout(title = 'Variables in reduced space')\nplot2 <- plot_ly(\n  res.pca$x %>% as.data.frame,\n  x = ~ PC1,\n  y = ~ PC2,\n  z = ~ PC3,\n  size = 2,\n  type = 'scatter3d',\n  mode = 'markers',\n  text = ~ paste('Participant:', rownames(res.pca$x))\n) %>%\n  layout(title = 'Participants in reduced space')\n\n# Display side by side using htmltools\ndiv(\n  style = \"display: flex; justify-content: space-between;\",\n  list(\n    div(plot1, style = \"width: 50%;\"),\n    div(plot2, style = \"width: 50%;\")\n  )\n)\n```\n\n::: {.cell-output-display}\n```{=html}\n<div style=\"display: flex; justify-content: space-between;\">\n<div style=\"width: 50%;\">\n<div class=\"plotly html-widget html-fill-item-overflow-hidden html-fill-item\" id=\"htmlwidget-7e34793eec02d5235a47\" style=\"width:100%;height:400px;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-7e34793eec02d5235a47\">{\"x\":{\"visdat\":{\"e91e1c0796b5\":[\"function () \",\"plotlyVisDat\"]},\"cur_data\":\"e91e1c0796b5\",\"attrs\":{\"e91e1c0796b5\":{\"x\":{},\"y\":{},\"z\":{},\"mode\":\"markers\",\"text\":{},\"size\":2,\"alpha_stroke\":1,\"sizes\":[10,100],\"spans\":[1,20],\"type\":\"scatter3d\"}},\"layout\":{\"margin\":{\"b\":40,\"l\":60,\"t\":25,\"r\":10},\"title\":\"Variables in reduced space\",\"scene\":{\"xaxis\":{\"title\":\"PC1\"},\"yaxis\":{\"title\":\"PC2\"},\"zaxis\":{\"title\":\"PC3\"}},\"hovermode\":\"closest\",\"showlegend\":false},\"source\":\"A\",\"config\":{\"modeBarButtonsToAdd\":[\"hoverclosest\",\"hovercompare\"],\"showSendToCloud\":false},\"data\":[{\"x\":[-0.033098873358161,-0.0193242470023178,0.0469603021080562,-0.0182057632607551,0.0562043139488134,-0.0155190187821303,-0.0256684313558672,0.0432780996987342,-0.035638977809439,-0.0209599554718235,-0.0714414949606447,-0.0240338586260801,-0.00138715114770807,-0.0192915992715336,0.0398994645697312,-0.0362792674826934,0.0107611654209515,-0.0789519945406437,-0.0420213781707481,0.0110527060115145,-0.109477820463447,-0.0402416509555468,-0.0187477714645794,-0.0235306998234048,-0.0918899391647817,-0.122169448210144,-0.0665554498882835,0.0162663289852702,0.123549948051221,-0.0920446401552571,-0.070955666361528,-0.133022780117098,-0.09187833182038,-0.0712293367366541,-0.0462972294497993,-0.143861301886469,0.0140351310288122,0.0396838362131044,0.0343421063665908,0.000152984002215369,-0.0146634218186005,0.155799716343071,-0.0111260676903966,0.117362866862135,0.0940397723991562,0.0784312217405099,0.0150870330769224,0.106267168303337,-0.0271083473349425,0.16709728219507,0.134768112162789,-0.0475679280312224,0.129766185749887,0.22118510883677,-0.0165547960230189,0.190031336096307,0.184821591213529,0.186851123509858,0.135688668054829,0.239704985665764,-0.0650957988290937,-0.230206658896924,-0.225336656220065,-0.137498615672657,0.136983162661683,-0.260930279770676,-0.0566005576301727,-0.194356195897914,-0.244059764813301,-0.220033376422009,-0.206933309671688,-0.276024806008],\"y\":[0.00291880531328598,0.195838865716988,0.0593344055963407,0.000279641891221483,0.0986102975083426,0.122048807067826,-0.016682343988488,0.109993842003211,0.193624476385402,0.0325833720489011,0.116518870550698,0.10668058572364,-0.0292553144940672,0.0661729696414339,0.0224126219766992,-0.0342389471593083,0.031556156086183,-0.0199435205894778,-0.00452690601483845,0.0909573245276608,0.0830028241918308,0.0246130218103901,-0.00660860250884728,0.0556850979354451,0.00094794039363885,0.0431657724510698,0.0247791731086576,0.0295461428053306,0.036926429982586,0.120780263551606,-0.00666261746569634,-0.0150761777628836,0.101366306740358,0.053177156089608,0.0927396794267762,0.005615444275792,-0.138665601003734,-0.300540289795401,-0.169489843594102,-0.0366122385393376,-0.261457063810502,-0.261465777586449,-0.115038398353273,-0.205786499178792,-0.238590008364744,-0.160803383534466,-0.322517543211876,-0.296464045864495,-0.0919344083008441,-0.0534311104393722,-0.0480434164730989,-0.0393055046653602,-0.0156790222308669,-0.00908955543044672,-0.0674008641415034,0.0135933637531847,0.0326389763054058,0.0589524667162354,-0.176144482623999,-0.0265649231494269,0.0204916512735801,-0.111575835992754,-0.0594199812535844,-0.0513890114727043,0.0821305323492833,-0.146197949383728,-0.0758989874941121,-0.110655355682677,-0.156679119729277,-0.150211826398927,0.00601526980191951,-0.116815543504527],\"z\":[-0.0280150336595125,-0.0340921959673595,0.0725014374618538,0.0141075296523455,0.0405688095571108,0.00828823683518842,-0.0129522308797194,0.110038850369719,0.0661917061934071,0.10764434575765,-0.0337213894214387,0.025805708199051,-0.0933153818485934,0.0263667995862944,-0.0668608294852715,0.000215764717026626,0.0525553507214646,-0.0354288795980517,0.0578672797660364,-0.0540199750976574,0.0450674736432118,0.142535259497413,0.140446995884003,0.0130754026058924,-0.146704463672108,-0.317097645856508,-0.247256087545436,-0.278831599691927,0.16051260516878,-0.229810805746078,-0.0514501095763441,-0.263008413297063,-0.245533358906998,-0.218861521451835,-0.239045570392392,-0.349209550164939,0.0513139533256889,-0.0473348536618677,-0.0161090671879065,0.128284211103142,-0.0877681486536031,-0.029370907418112,-0.0116393867300802,-0.0939029079421428,-0.031900205920542,-0.077387974556129,-0.0363769429073978,-0.0384743047867409,0.0420293874384342,-0.134527153987811,0.0626094661576748,0.156403647820868,-0.102507837306508,-0.0323871901647364,-0.0559989025033128,-0.0992833141140824,-0.058251844310624,-0.0617521675263774,-0.0753844240010002,-0.120106980101693,-0.00969227906072718,0.0569333219626552,-0.0439725278731393,-0.0966570841151717,-0.0785060111331655,0.0737186666270611,-0.0208247388514617,0.0715949351162773,0.0238138384619704,0.0291818578361594,0.0813559489834362,0.08346634122615],\"mode\":\"markers\",\"text\":[\"Variable: AttitudesDutch_ar01\",\"Variable: AttitudesPartner_ar01\",\"Variable: DaytimeNeedFulfillment_ar01\",\"Variable: exWB_ar01\",\"Variable: InteractionContextAccidental_ar01\",\"Variable: InteractionContextCooperative_ar01\",\"Variable: InteractionContextRepresentativeNL_ar01\",\"Variable: InteractionContextvoluntary_ar01\",\"Variable: KeyNeedDueToPartner_ar01\",\"Variable: KeyNeedFulfillment_ar01\",\"Variable: qualityMeaning_ar01\",\"Variable: qualityOverall_ar01\",\"Variable: AttitudesDutch_edf\",\"Variable: AttitudesPartner_edf\",\"Variable: DaytimeNeedFulfillment_edf\",\"Variable: exWB_edf\",\"Variable: InteractionContextAccidental_edf\",\"Variable: InteractionContextCooperative_edf\",\"Variable: InteractionContextRepresentativeNL_edf\",\"Variable: InteractionContextvoluntary_edf\",\"Variable: KeyNeedDueToPartner_edf\",\"Variable: KeyNeedFulfillment_edf\",\"Variable: qualityMeaning_edf\",\"Variable: qualityOverall_edf\",\"Variable: AttitudesDutch_lin\",\"Variable: AttitudesPartner_lin\",\"Variable: DaytimeNeedFulfillment_lin\",\"Variable: exWB_lin\",\"Variable: InteractionContextAccidental_lin\",\"Variable: InteractionContextCooperative_lin\",\"Variable: InteractionContextRepresentativeNL_lin\",\"Variable: InteractionContextvoluntary_lin\",\"Variable: KeyNeedDueToPartner_lin\",\"Variable: KeyNeedFulfillment_lin\",\"Variable: qualityMeaning_lin\",\"Variable: qualityOverall_lin\",\"Variable: AttitudesDutch_mac\",\"Variable: AttitudesPartner_mac\",\"Variable: DaytimeNeedFulfillment_mac\",\"Variable: exWB_mac\",\"Variable: InteractionContextAccidental_mac\",\"Variable: InteractionContextCooperative_mac\",\"Variable: InteractionContextRepresentativeNL_mac\",\"Variable: InteractionContextvoluntary_mac\",\"Variable: KeyNeedDueToPartner_mac\",\"Variable: KeyNeedFulfillment_mac\",\"Variable: qualityMeaning_mac\",\"Variable: qualityOverall_mac\",\"Variable: AttitudesDutch_mad\",\"Variable: AttitudesPartner_mad\",\"Variable: DaytimeNeedFulfillment_mad\",\"Variable: exWB_mad\",\"Variable: InteractionContextAccidental_mad\",\"Variable: InteractionContextCooperative_mad\",\"Variable: InteractionContextRepresentativeNL_mad\",\"Variable: InteractionContextvoluntary_mad\",\"Variable: KeyNeedDueToPartner_mad\",\"Variable: KeyNeedFulfillment_mad\",\"Variable: qualityMeaning_mad\",\"Variable: qualityOverall_mad\",\"Variable: AttitudesDutch_median\",\"Variable: AttitudesPartner_median\",\"Variable: DaytimeNeedFulfillment_median\",\"Variable: exWB_median\",\"Variable: InteractionContextAccidental_median\",\"Variable: InteractionContextCooperative_median\",\"Variable: InteractionContextRepresentativeNL_median\",\"Variable: InteractionContextvoluntary_median\",\"Variable: KeyNeedDueToPartner_median\",\"Variable: KeyNeedFulfillment_median\",\"Variable: qualityMeaning_median\",\"Variable: qualityOverall_median\"],\"type\":\"scatter3d\",\"marker\":{\"color\":\"rgba(31,119,180,1)\",\"size\":[55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55],\"sizemode\":\"area\",\"line\":{\"color\":\"rgba(31,119,180,1)\"}},\"textfont\":{\"size\":55},\"error_y\":{\"color\":\"rgba(31,119,180,1)\",\"width\":55},\"error_x\":{\"color\":\"rgba(31,119,180,1)\",\"width\":55},\"line\":{\"color\":\"rgba(31,119,180,1)\",\"width\":55},\"frame\":null}],\"highlight\":{\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.2,\"selected\":{\"opacity\":1},\"debounce\":0},\"shinyEvents\":[\"plotly_hover\",\"plotly_click\",\"plotly_selected\",\"plotly_relayout\",\"plotly_brushed\",\"plotly_brushing\",\"plotly_clickannotation\",\"plotly_doubleclick\",\"plotly_deselect\",\"plotly_afterplot\",\"plotly_sunburstclick\"],\"base_url\":\"https://plot.ly\"},\"evals\":[],\"jsHooks\":[]}</script>\n</div>\n<div style=\"width: 50%;\">\n<div class=\"plotly html-widget html-fill-item-overflow-hidden html-fill-item\" id=\"htmlwidget-36d3c37f33c360912895\" style=\"width:100%;height:400px;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-36d3c37f33c360912895\">{\"x\":{\"visdat\":{\"e91e36375373\":[\"function () \",\"plotlyVisDat\"]},\"cur_data\":\"e91e36375373\",\"attrs\":{\"e91e36375373\":{\"x\":{},\"y\":{},\"z\":{},\"mode\":\"markers\",\"text\":{},\"size\":2,\"alpha_stroke\":1,\"sizes\":[10,100],\"spans\":[1,20],\"type\":\"scatter3d\"}},\"layout\":{\"margin\":{\"b\":40,\"l\":60,\"t\":25,\"r\":10},\"title\":\"Participants in reduced space\",\"scene\":{\"xaxis\":{\"title\":\"PC1\"},\"yaxis\":{\"title\":\"PC2\"},\"zaxis\":{\"title\":\"PC3\"}},\"hovermode\":\"closest\",\"showlegend\":false},\"source\":\"A\",\"config\":{\"modeBarButtonsToAdd\":[\"hoverclosest\",\"hovercompare\"],\"showSendToCloud\":false},\"data\":[{\"x\":[2.96522693559847,1.09457869740568,3.67138714059734,-0.678365643198777,3.27016867708549,0.860927749887711,4.71139723481653,2.80943820138906,2.49614096763307,-1.70385205180253,0.39842092036974,4.63194972829537,1.92878596662369,1.35702412522018,1.87235797484993,3.04472104371624,-1.7578934990684,-0.367063546288292,-1.56177986559414,0.70410771633328,-4.24448148299478,0.723800658479373,2.91787189995494,-0.0876947035629787,4.21646878390255,-4.76103942425927,-0.3630070784246,2.31819902016858,3.32887629886372,-1.37583024704692,-2.44482213831629,-2.02887089535595,-2.59088338866332,-2.95682760890489,3.00947014932989,2.52633285343927,-1.82359519129392,-0.487544796885141,-1.70824823844589,4.95133976648446,-1.36862357029559,-3.90850884121153,-0.0477888787531106,5.2010801819802,1.09598360141496,-2.23732957316626,1.48454023000915,3.65461519132529,0.52166800188939,-3.78472840890866,2.71683370007702,-6.83015267711008,-0.999918294937798,-2.73616778272104,3.27888777073358,0.283081443791593,-2.49352853932406,0.53548846225501,0.447503496992873,4.45873036601313,0.161132636386943,3.20899284398207,-2.0182323642275,-4.67943408653218,1.43165462608789,5.52462579756653,-5.44483647990615,1.18890151075743,-4.7658449088802,-2.47350466370884,-3.92688926172904,-0.0317106400269587,2.58937971713185,-0.341535125707907,3.33158248197013,-1.96843497493544,1.3112467830414,2.34653204964593,2.04020020527173,-3.46712776981991,-4.67419749479449,2.3753903990205,-3.68737694554983,-4.23479317464334,-1.02220952879962,-4.04431178120443,-4.22687353642802,1.72555307491521,-0.701675013838611,0.337502415677927,1.46056423034443,-4.04371331953351,-1.99802123819175,1.22182566544893,0.188100490103333,-3.45649931301569,-4.47286555437928,1.71886513625189,-1.74814014088212,1.82222291284267,-3.7030695003979,-2.36199568243961,-1.5311606178196,-0.92490435633668,2.77306785744962,-1.59660236292213,3.82161615005582,-3.91529226144241,1.52718030825142,2.45274208802279,-1.02782678967824,2.99921010141625,1.00657922167423,-3.68560671280166,-3.35413462019581,2.34253300195909,0.352846704679636,5.49753214478115,0.490279579741647,1.83318047183125,1.10304473913906,-1.2694068848251,3.58378604315421,-0.377330236975635,-1.80348048473028,-2.42756635862774,-3.72490096753946,-0.358494509186792,-2.05506771037223,-2.20105332978451,2.33317905658468,3.71063451529735,3.14628629491384,1.50542701933482,-2.13278502770424,3.03944422885052,3.16143432458082,-0.711776270603902,3.02942493344131,1.97711530230208,-3.00411243702203,-2.83772291618528,-0.534615992411501,1.62726810496631,-1.2016433759863,0.0540830099498507,5.67278760541841,-3.72168353051118,1.63450978730876,-0.429538795551428,-0.0134465766413219,-1.19488043193283,2.65197730061439,-4.38270856257562,-1.62883822742201,0.089571384799646],\"y\":[4.87549654670305,1.72213531518511,6.99994814533333,-0.18672769377431,6.60903748270317,5.30807000723732,1.67335274436665,2.16481535605123,0.749926389409499,2.75089829477375,2.91825040575653,-0.632692256637443,3.1488203847602,2.40749393577763,0.377431449866779,0.685427024302977,5.57897543900249,5.31102725793829,1.95002758966909,3.10604080354848,-2.31504504240128,-0.274613912350838,-3.09298113150578,-2.99876953230849,-4.32782790251105,0.632542109024643,0.73756502663569,0.282828372715213,-0.308663011495715,0.908339747336907,-3.52634145898745,2.13825846494851,-4.01627706651483,-1.67273547087918,-4.00462266841984,-0.930289716567585,-1.11387337009002,-1.12056286486618,1.18224980965128,0.887757338279384,-0.546065645187765,3.37650942000526,-0.575119696358271,8.49126347143659,0.744631215565855,-2.18495501543107,-3.67549410523562,-0.948552887245133,-3.99340821880679,1.39888741021061,-0.167254321786321,2.69949826970243,1.80122686238506,-0.269020086290745,4.14786498325711,-4.16250234756203,-2.32252164622075,-1.42846139121539,1.41076903530711,-5.14833257424684,2.10967838748248,-2.66912901899748,-2.7697124422509,2.60639470579049,-0.834900138379941,1.28260694204203,-1.21714086843201,0.187989911414976,0.0182683440408908,0.574541482664824,-1.36082931919736,-0.598380507244958,0.714399231898082,5.04811604176723,-2.33894405113728,-2.03263258965105,5.11358228332203,0.939486036777212,-1.57068278002299,-0.69966858978481,-0.678541268570645,-0.553488060743008,-2.02768998731187,0.691011600204705,3.0154948190156,-0.199504514113619,4.45262217306653,-2.17915249251457,-0.788087004174901,-0.505649478207096,1.20652590266964,-0.05783584371728,-2.2329870570889,-0.1934501397291,0.291617754126471,-1.09248727487197,2.41792544579271,-0.952649558764704,-3.07689722881115,-2.42268148192296,-2.11143776286739,1.58854333762249,-0.0254116900706696,-0.688290875794619,-4.12295738995692,0.814201886659337,-0.745149381416292,0.120482598189046,-1.4039750577401,-1.10109948906673,1.10523854868983,2.37795078894805,-0.0972734371318104,-2.64164986127009,-0.306596622004281,0.988049606826148,-0.385710615673492,-0.822534193490518,3.09474193126885,-1.30185794301802,-2.82175890645761,2.21464986646866,-1.92012534033926,-0.230790888179262,-2.71202683415248,0.677586030430092,1.07291714563788,-3.31130739802507,-1.47444306587839,1.33320945981429,3.69300781219797,1.79531168365749,-0.440821249420571,-0.944102935715346,-0.897957574511638,-0.978158238432977,1.61494696563365,2.49817357445307,0.0278043975608711,-3.77234290473002,-0.134462007105745,-0.867009950526018,0.429327020546668,-2.14366163931072,-0.826169351669151,-3.17646058645544,-4.33922002767366,1.12858292408594,-2.66499948543145,-3.79106520785141,-0.471880741895654,-1.06438649827187,-5.04339086728951,-0.0138292718597269,-1.58944327732042,3.95823854892814],\"z\":[0.107877134407874,0.452522689978429,0.778027530546034,3.97038728646298,-0.991001633609633,1.00847412159627,0.806713354791733,-1.14455246922731,-4.00845920537333,-1.48014982359006,1.85841398390231,2.43099571901954,-0.233720979715119,0.861030680218443,7.08057496484512,-3.34695378357863,-3.60359940369951,-2.79790923739381,0.691212539207088,0.422573631317613,-0.217549347131125,-0.850597414592154,-3.68576731426329,-1.9497541305154,-0.575688386709392,2.70455861399627,-1.68958559309515,-2.52153627457599,0.0963384134214537,-0.793866942619068,0.0454774111328591,0.226539298281533,-1.90064592767021,-1.00048311866405,-0.815153496708493,-1.6190717536883,-0.447444744390607,-1.96521541985938,-0.391024355257301,-0.952225523284422,-1.27372223602425,-1.14704658568459,-0.240364745640435,5.82800821961457,-0.153655588665826,0.616656959585564,-2.13731321902726,-2.02108868554322,-0.320374352438907,-0.736601553714413,0.979437283306703,-1.5612628520455,-0.53297479462779,0.484565148733124,-4.43880730399289,2.66926030690374,-2.15703205344753,-3.07728201183522,-0.459558050685356,2.16639289761765,1.32207934801319,-1.83312424615146,-0.863340547700673,0.561094211614427,1.98404920346851,-1.16599606432154,-1.11598332664299,0.744335794559877,-1.63541066193683,-1.91179543599445,0.0333713776721578,0.0497732110405724,2.37537127003541,1.20026212132676,1.09608278105591,-0.545609437960926,-0.44813526061146,0.000118046221859919,0.628055281621254,0.272263206069893,-0.391126881278338,-0.949582508789951,-1.43370789915215,0.117459965864772,0.229678075798662,3.38891039782682,-4.94949982164279,-2.19856455936854,2.38632164473167,1.43194155853871,-4.21563508085095,-0.357344844485001,1.65104134780003,0.488322179091825,-4.3187939488441,0.0944132596116782,1.16670897269049,2.76242061451843,0.665485948875266,-0.814924845222442,-1.89006812493732,-1.82150903630779,3.01819174577808,-1.84445981421106,0.0938193046343707,1.69815497491566,0.17534607403783,0.311277144889123,-0.912128443720296,-1.44218057512667,1.42265170831572,1.88966609045923,-0.376347573302898,-0.114167568489513,3.57674284684074,-1.29802279174616,1.39438515603422,1.35198369733949,1.42106307215002,1.95095149435467,0.477831853727819,0.0665069119756943,-1.11033676643331,0.382625075308118,0.460694097885375,-2.23496043006015,1.44140442024639,5.21164600383074,0.35995829050151,1.21493894126561,0.784153467153173,0.111922196984044,-0.0870531698572455,2.2281340439035,0.591674825446873,3.559938068601,-0.495582758303286,0.4164459966973,-0.415973898193462,0.426080554765896,5.15126407597119,1.70115792614087,0.216002781009657,2.41856093612794,1.23395614694345,0.522581543730697,-1.76679799220217,-0.148936109470166,0.834074532476559,2.23893376042542,-1.03043319529967,-3.61246506679913,-3.78801229957858,1.27793691837774,1.55774523002291,-1.3489486186253],\"mode\":\"markers\",\"text\":[\"Participant: 1\",\"Participant: 2\",\"Participant: 3\",\"Participant: 4\",\"Participant: 5\",\"Participant: 6\",\"Participant: 7\",\"Participant: 8\",\"Participant: 9\",\"Participant: 10\",\"Participant: 11\",\"Participant: 12\",\"Participant: 13\",\"Participant: 14\",\"Participant: 15\",\"Participant: 16\",\"Participant: 17\",\"Participant: 18\",\"Participant: 20\",\"Participant: 21\",\"Participant: 22\",\"Participant: 23\",\"Participant: 24\",\"Participant: 25\",\"Participant: 26\",\"Participant: 27\",\"Participant: 28\",\"Participant: 29\",\"Participant: 30\",\"Participant: 31\",\"Participant: 32\",\"Participant: 33\",\"Participant: 34\",\"Participant: 35\",\"Participant: 36\",\"Participant: 37\",\"Participant: 38\",\"Participant: 39\",\"Participant: 40\",\"Participant: 41\",\"Participant: 42\",\"Participant: 43\",\"Participant: 44\",\"Participant: 45\",\"Participant: 46\",\"Participant: 47\",\"Participant: 48\",\"Participant: 49\",\"Participant: 50\",\"Participant: 51\",\"Participant: 52\",\"Participant: 53\",\"Participant: 54\",\"Participant: 55\",\"Participant: 56\",\"Participant: 57\",\"Participant: 58\",\"Participant: 59\",\"Participant: 60\",\"Participant: 61\",\"Participant: 62\",\"Participant: 63\",\"Participant: 64\",\"Participant: 65\",\"Participant: 66\",\"Participant: 67\",\"Participant: 68\",\"Participant: 69\",\"Participant: 70\",\"Participant: 71\",\"Participant: 72\",\"Participant: 73\",\"Participant: 74\",\"Participant: 75\",\"Participant: 76\",\"Participant: 77\",\"Participant: 78\",\"Participant: 79\",\"Participant: 80\",\"Participant: 81\",\"Participant: 82\",\"Participant: 83\",\"Participant: 84\",\"Participant: 85\",\"Participant: 86\",\"Participant: 87\",\"Participant: 88\",\"Participant: 89\",\"Participant: 90\",\"Participant: 91\",\"Participant: 92\",\"Participant: 93\",\"Participant: 94\",\"Participant: 95\",\"Participant: 96\",\"Participant: 97\",\"Participant: 98\",\"Participant: 99\",\"Participant: 100\",\"Participant: 101\",\"Participant: 102\",\"Participant: 103\",\"Participant: 104\",\"Participant: 105\",\"Participant: 106\",\"Participant: 107\",\"Participant: 108\",\"Participant: 109\",\"Participant: 110\",\"Participant: 111\",\"Participant: 112\",\"Participant: 113\",\"Participant: 114\",\"Participant: 115\",\"Participant: 116\",\"Participant: 117\",\"Participant: 118\",\"Participant: 119\",\"Participant: 120\",\"Participant: 121\",\"Participant: 122\",\"Participant: 123\",\"Participant: 124\",\"Participant: 125\",\"Participant: 126\",\"Participant: 127\",\"Participant: 128\",\"Participant: 129\",\"Participant: 130\",\"Participant: 131\",\"Participant: 132\",\"Participant: 133\",\"Participant: 134\",\"Participant: 135\",\"Participant: 136\",\"Participant: 137\",\"Participant: 138\",\"Participant: 139\",\"Participant: 140\",\"Participant: 141\",\"Participant: 142\",\"Participant: 143\",\"Participant: 144\",\"Participant: 145\",\"Participant: 146\",\"Participant: 147\",\"Participant: 148\",\"Participant: 149\",\"Participant: 150\",\"Participant: 151\",\"Participant: 152\",\"Participant: 153\",\"Participant: 154\",\"Participant: 155\",\"Participant: 156\",\"Participant: 157\"],\"type\":\"scatter3d\",\"marker\":{\"color\":\"rgba(31,119,180,1)\",\"size\":[55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55],\"sizemode\":\"area\",\"line\":{\"color\":\"rgba(31,119,180,1)\"}},\"textfont\":{\"size\":55},\"error_y\":{\"color\":\"rgba(31,119,180,1)\",\"width\":55},\"error_x\":{\"color\":\"rgba(31,119,180,1)\",\"width\":55},\"line\":{\"color\":\"rgba(31,119,180,1)\",\"width\":55},\"frame\":null}],\"highlight\":{\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.2,\"selected\":{\"opacity\":1},\"debounce\":0},\"shinyEvents\":[\"plotly_hover\",\"plotly_click\",\"plotly_selected\",\"plotly_relayout\",\"plotly_brushed\",\"plotly_brushing\",\"plotly_clickannotation\",\"plotly_doubleclick\",\"plotly_deselect\",\"plotly_afterplot\",\"plotly_sunburstclick\"],\"base_url\":\"https://plot.ly\"},\"evals\":[],\"jsHooks\":[]}</script>\n</div>\n</div>\n```\n:::\n:::\n\n\n### Save Principal Component Scores\n\nFor the extracted principal components we save the 27 principal component scores for each participant (i.e., the participants' coordinates in the reduced dimensional space; PC-scores) in the `pca_scores` data frame.\n\n\n::: {.cell}\n\n```{.r .numberLines .lineAnchors .cell-code}\n# extract coordinates for the individuals (PC-scores)\npca_scores <- as.data.frame(res.pca$x[,1:pca_cutoff])\n```\n:::\n\n\nIt is important to note that we do not standardize the principal component scores again before adding them into the clustering algorithm. With the PCs the differences in variances are crucial to the dimensionality reduction and standardizing the PC-scores would remove this information.\n\n\n::: {.cell}\n\n```{.r .numberLines .lineAnchors .cell-code}\npca_scores %>%\n  summarize_all(sd) %>%\n  pivot_longer(everything(), names_to = \"PC\", values_to = \"sd\") %>%\n  ggplot(., aes(x=reorder(PC, sd), y=sd, label=sd)) +\n  geom_bar(stat='identity', width=.5) +\n  coord_flip() +\n  labs(\n    x = \"Principal Component\",\n    y = \"Standard Deviation\",\n    title = \"Standard Deviation of each Principal Component\"\n  ) +\n  theme_Publication()\n```\n\n::: {.cell-output-display}\n![](03-feature-reduction_files/figure-html/visualize the standard deviations of each extracted component-1.png){width=672}\n:::\n:::\n\n\nWith the reduced variable space of the PC-scores we can now move on to the clustering of the data.\n\n\n\n\n\n## References\n\n::: {#refs}\n:::",
    "supporting": [
      "03-feature-reduction_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"site_libs/kePrint-0.0.1/kePrint.js\"></script>\n<link href=\"site_libs/lightable-0.0.1/lightable.css\" rel=\"stylesheet\" />\n<script src=\"site_libs/htmlwidgets-1.6.2/htmlwidgets.js\"></script>\n<script src=\"site_libs/plotly-binding-4.10.1/plotly.js\"></script>\n<script src=\"site_libs/typedarray-0.1/typedarray.min.js\"></script>\n<script src=\"site_libs/jquery-3.5.1/jquery.min.js\"></script>\n<link href=\"site_libs/crosstalk-1.2.0/css/crosstalk.min.css\" rel=\"stylesheet\" />\n<script src=\"site_libs/crosstalk-1.2.0/js/crosstalk.min.js\"></script>\n<link href=\"site_libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css\" rel=\"stylesheet\" />\n<script src=\"site_libs/plotly-main-2.11.1/plotly-latest.min.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}